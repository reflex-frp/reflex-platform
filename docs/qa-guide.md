## Test Plan for Reflex-Platform
```
mkdir rp-sandbox
cd rp-sandbox
git clone git@github.com:reflex-frp/reflex-platform.git
cd reflex-platform
git checkout <git commit that you are testing>
```
### Making sure that the try-reflex shell works
```
./try-reflex
```
Copy the following into the shell (all at once):
```
cat >hello.hs <<EOF
{-# LANGUAGE OverloadedStrings #-}
import Reflex.Dom
main = mainWidget $ text "Hello, world!"
EOF
```
```
ghc hello.hs
./hello
```
If you are running on this command on a mac you will need to add the `dynamic` and `threading` flags each time you invoke ghc:
See below for an example
```
ghc -dynamic -threading hello.hs
```

Test out ghcjs:
```
ghcjs hello.hs
chromium hello.jsexe/index.html
```

### Testing the host.hs example
```
ghc examples/host.hs
./examples/host
```
Follow the instructions and confirm that the output event is a sequence of all of the letters you have entered
To exit, ctrl-c. 
Exit the try-reflex shell with the exit command
```
exit
```

### Generating Documentation
```
./scripts/docs-for reflex
./scripts/docs-for reflex-dom
```

### Running a build on the web
```
nix-build -A ghcjs.reflex-todomvc
```
If successful this will give you a file path. Navigate to a browser (like chrome) and enter the following (with the path) into the bar:
```
file:///<insert nix path from previous instruction here>/bin/reflex-todomvc.jsexe/index.html
```
You should test this app. 

### Android App:
If you are running qa from a macOS machine please skip the android tests, but be sure to QA it from a linux device.
```
nix-build release.nix -A x86_64-linux.androidReflexTodomvc
```
Use the line generated by the command above to run the next command
Make sure that your android device has been plugged in, that you have deleted any app titled "reflex-todomvc" from the phone, and that you have unlocked and accepted permissions on the phone before running the following:
```
<nix path from command above>/bin/deploy
```
### Testing TODOMVC app on IOS
Using a macOS run the following:
Make sure the device that you are installing the app on is plugged in.
```
nix-build release.nix -A x86_64-darwin.iosReflexTodomvc
result/bin/deploy <team-id>
```
For more information on finding out what your team-id is, please see the README.md

### Testing the 'work-on-multi' script
```
scripts/hack-on haskell-overlays/reflex-packages/dep/reflex-dom
nano cabal.project.local
```
Enter and save the following:
```
packages:
  haskell-overlays/reflex-packages/dep/reflex-dom/reflex-dom-core
  haskell-overlays/reflex-packages/dep/reflex-dom/reflex-dom
  examples/WorkOnTest/
```

Run the work-on script:
```
scripts/work-on ghc './examples/WorkOnTest/'
cd examples/WorkOnTest
cabal new-build
cabal new-run
cd ../../
exit
```
If you are running these commands from a macOS, you will need to add the following to the
cabal new-build and cabal new-run commands: 
```
cabal new-build --ghc-options='-threaded -dynamic'
cabal new-run --ghc-options='-threaded -dynamic'
```
Please confirm that "hello world" pops up when running `cabal new-run`

Run the work-on-multi script:
```
scripts/work-on-multi ghc reflex-dom reflex-dom-core
cabal new-build all
cabal new-run WorkOnTest
exit
scripts/hack-off haskell-overlays/reflex-packages/dep/reflex-dom
```

### Removing the sandbox dir:
```
cd ../../
rm -rf rp-sandbox
```
